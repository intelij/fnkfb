YUI.add("tictac-dropbox-alfview",function e(o){var t=o.Tictac,r=t.base.utils.log,a=t.dropbox.Stats.stat,n=o.Tictac.dropbox.strings,l,i,c,d,s,u=[];function p(){if(i){i.destroy()}o.Array.each(u,function(e){e.detach()});u=[]}function f(){o.each(s,function(e){if(e.uploadState!=="success"){d.deleteAttachment(e.id)}})}function b(){a("dropbox_alf_cancel_button");f();p()}function _(e){return o.Array.filter(e,function(e){if(!e.isDropbox()||e.uploadState==="success"){return false}return e.dropbox.alf})}function x(e){o.common.ui.DialogHelper.cancelDialog({hd:n.str_db_attach_large_files,bd:o.Tictac.dropbox.rollups.quota({body_text:e.body_text,link:e.link,link_text:e.link_text,end_text:e.end_text}),noScroll:true},{cancel:{handler:p}},function(e){i=e})}function g(){o.common.ui.DialogHelper.cancelDialog({hd:n.str_db_attach_large_files,bd:'<div id="dropboxALF"></div>',noScroll:true},{cancel:{handler:b}},function(e){var o=e.get("contentBox");e.hide();o.addClass("tictac-dropbox-alf-dialog");o.one(".modal-bd").addClass("dropbox-loading");e.show();e.center();i=e});var e=_(c.getAll(true)),t=e[e.length-1],a=i.get("contentBox"),l=a.one("#dropboxALF"),d=o.Tictac.dropbox.rollups.alfview,g=1,h,m;s=e;function v(e){if(!e.isDropbox()||!e.dropbox.alf){return}if(e.uploadState==="success"){if(e.id===t.id){m.cleanup();p()}else{g++;m.cleanup();l.empty();w(true)}return}if(e.uploadState==="failed"){var r;f();m.cleanup();l.empty();w();h.setHTML(n.str_dropbox_alf_error_uploading.replace("{{filename}}",e.filename));switch(e.reason){case"over_quota":p();x({body_text:n.str_dropbox_alf_over_quota_error,link:"https://www.dropbox.com/help/275",link_text:n.str_dropbox_alf_over_quota_error_link,end_text:""});return;case"invalid_token":r=n.str_dropbox_alf_problem_connecting;o.Tictac.dropbox.auth.deleteToken();break;default:r=n.str_dropbox_alf_unknown_error}l.one(".dropbox-alf-error").setHTML(r);return}if(e.hasProgress){m.set(e.progress);h.setHTML(e.filename);h.setAttribute("title",e.filename)}}function w(t){l.append(d({num:g,total:e.length}));if(t){m=new o.Tictac.widget.Progressbar;m.render(l.one(".dropbox-alf-progressbar"))}h=l.one(".dropbox-alf-filename")}r("alfview: on ModelReady",e);a.one(".modal-bd").removeClass("dropbox-loading");w(true);u.push(c.on("updated",v))}l={register:function(e,o){c=e;d=o;u.push(c.once("commit",this.onModelReady))},onModelReady:g,getDropboxALF:_,cleanup:p};o.namespace("Tictac.dropbox").alfview=l},"1.0.0",{requires:["common-ui-dialog-helper","tictac-base-utils","tictac-dropbox-stats","tictac-dropbox-strings","tictac-dropbox-rollups","tictac-att-progressbar"]});YUI.add("tictac-dropbox-api",function(e){(function(){var e,o,n,r,t,i,s,a,c,p,f,u,d;if((f=window.Dropbox)==null){window.Dropbox={}}if((u=Dropbox.baseUrl)==null){Dropbox.baseUrl="https://www.dropbox.com"}if((d=Dropbox.blockBaseUrl)==null){Dropbox.blockBaseUrl="https://dl.dropbox.com"}Dropbox.addListener=function(e,o,n){if(e.addEventListener){e.addEventListener(o,n,false)}else{e.attachEvent("on"+o,function(e){e.preventDefault=function(){return this.returnValue=false};return n(e)})}};Dropbox.removeListener=function(e,o,n){if(e.removeEventListener){e.removeEventListener(o,n,false)}else{e.detachEvent("on"+o,n)}};e=function(e){var o,n;n=encodeURIComponent(Dropbox.VERSION);o=e.indexOf("?")===-1?"?":"&";return""+e+o+"version="+n};o=function(o,n){var r,t,i,s,a,c,p,f,u;c=encodeURIComponent(window.location.protocol+"//"+window.location.host);r=encodeURIComponent(Dropbox.appKey);s=encodeURIComponent(o.linkType||"");p=encodeURIComponent(o._trigger||"js");a=Boolean(o.multiselect);t=encodeURIComponent(((u=o.extensions)!=null?typeof u.join==="function"?u.join(" "):void 0:void 0)||"");i=Boolean(o.folderselect);n=Boolean(n);f=""+Dropbox.baseUrl+"/chooser?origin="+c+"&app_key="+r+"&link_type="+s;f+="&trigger="+p+"&multiselect="+a+"&extensions="+t+"&folderselect="+i+"&iframe="+n;return e(f)};p=function(o){var n,r,t;r=encodeURIComponent(window.location.protocol+"//"+window.location.host);n=encodeURIComponent(Dropbox.appKey);t=""+Dropbox.baseUrl+"/saver?origin="+r+"&app_key="+n;if(Dropbox.forceDropdown){t+="&force_dropdown=1"}return e(t)};a=1;t=function(o,n){var r,t,i,s;r=encodeURIComponent(Dropbox.appKey);s=""+Dropbox.baseUrl+"/dropins/job_status?job="+n+"&app_key="+r;s=e(s);i=function(e){var n;if(e.status==="COMPLETE"){if(typeof o.progress==="function"){o.progress(1)}if(typeof o.success==="function"){o.success()}}else if((n=e.status)==="PENDING"||n==="DOWNLOADING"){if(e.progress!=null){if(typeof o.progress==="function"){o.progress(e.progress/100)}}setTimeout(t,1500)}else if(e.status==="FAILED"){if(typeof o.error==="function"){o.error(e.error)}}};if("withCredentials"in new XMLHttpRequest){t=function(){var e;e=new XMLHttpRequest;e.onload=function(){return i(JSON.parse(e.responseText))};e.onerror=function(){return typeof o.error==="function"?o.error():void 0};e.open("GET",s,true);return e.send()}}else if(!Dropbox.disableJSONP){t=function(){var e,n,r;e="DropboxJsonpCallback"+a++;n=false;window[e]=function(e){n=true;return i(e)};r=document.createElement("script");r.src=""+s+"&callback="+e;r.onreadystatechange=function(){var e;if(r.readyState==="loaded"){if(!n){if(typeof o.error==="function"){o.error()}}return(e=r.parentNode)!=null?e.removeChild(r):void 0}};return document.getElementsByTagName("head")[0].appendChild(r)}}else if(typeof XDomainRequest!=="undefined"&&XDomainRequest!==null&&"https:"===document.location.protocol){t=function(){var e;e=new XDomainRequest;e.onload=function(){return i(JSON.parse(e.responseText))};e.onerror=function(){return typeof o.error==="function"?o.error():void 0};e.open("get",s);return e.send()}}else{throw new Error("Unable to find suitable means of cross domain communication")}if(typeof o.progress==="function"){o.progress(0)}return t()};i=function(e,o,n){var r,i,a;r=JSON.parse(e.data);switch(r.method){case"ready":if(n.files!=null){a=JSON.stringify({method:"files",params:n.files});if(typeof s!=="undefined"&&s!==null&&n._popup){i=s.contentWindow}else{i=e.source}i.postMessage(a,Dropbox.baseUrl)}if(typeof n.ready==="function"){n.ready()}break;case"files_selected":case"files_saved":if(typeof o==="function"){o()}if(typeof n.success==="function"){n.success(r.params)}break;case"progress":if(typeof n.progress==="function"){n.progress(r.params)}break;case"close_dialog":if(typeof o==="function"){o()}if(typeof n.cancel==="function"){n.cancel()}break;case"web_session_error":if(typeof o==="function"){o()}if(typeof n.webSessionFailure==="function"){n.webSessionFailure()}break;case"web_session_unlinked":if(typeof o==="function"){o()}if(typeof n.webSessionUnlinked==="function"){n.webSessionUnlinked()}break;case"resize":if(typeof n.resize==="function"){n.resize(r.params)}break;case"error":if(typeof o==="function"){o()}if(typeof n.error==="function"){n.error(r.params)}break;case"job_id":if(typeof o==="function"){o()}t(n,r.params);break;case"_debug_log":if(typeof console!=="undefined"&&console!==null){}}};s=null;n=function(){if(/\bTrident\b/.test(navigator.userAgent)){s=document.createElement("iframe");s.setAttribute("id","dropbox_xcomm");s.setAttribute("src",Dropbox.baseUrl+"/static/api/1/xcomm.html");s.style.display="none";document.getElementsByTagName("body")[0].appendChild(s)}};Dropbox.createChooserWidget=function(e){var n;n=r(o(e,true));n._handler=function(o){if(o.source===n.contentWindow&&o.origin===Dropbox.baseUrl){i(o,null,e)}};Dropbox.addListener(window,"message",n._handler);return n};Dropbox.cleanupWidget=function(e){if(!e._handler){throw new Error("Invalid widget!")}Dropbox.removeListener(window,"message",e._handler);delete e._handler};c=function(e,o){var n,r;n=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-e)/2;r=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-o)/2;return"width="+e+",height="+o+",left="+n+",top="+r};Dropbox.init=function(e,o){n();Dropbox.appKey=e;Dropbox.webSessionToken=""};Dropbox.setWebSessionToken=function(e){Dropbox.webSessionToken=e};Dropbox.getWebSessionApproval=function(e,o){var n,r,t,i,a;if(o==null){o={}}i=encodeURIComponent(window.location.protocol+"//"+window.location.host);n=encodeURIComponent(Dropbox.appKey);o=encodeURIComponent(JSON.stringify(o));r=c(660,440);a=window.open(""+Dropbox.baseUrl+"/dropins/confirm_web_session?origin="+i+"&app_key="+n+"&user_info="+o,"dropbox_confirm_web_session",""+r+",location=yes");t=function(o){var n;if((o.source===a||o.source===(s!=null?s.contentWindow:void 0))&&o.origin===Dropbox.baseUrl){Dropbox.removeListener(window,"message",t);a.close();n=JSON.parse(o.data);switch(n.method){case"web_session_token":if(typeof e.success==="function"){e.success(n.params)}break;case"web_session_error":if(typeof e.cancel==="function"){e.cancel()}}}};Dropbox.addListener(window,"message",t)};Dropbox.checkWebSessionToken=function(e){var o,n,r,t,i;n=encodeURIComponent(Dropbox.webSessionToken);r=""+Dropbox.baseUrl+"/dropins/check_web_session_token?web_session_token="+n;o=function(o){var n;n=JSON.parse(o);if(n["error"]!=null){if(typeof e.failure==="function"){e.failure(n)}}else{if(typeof e.success==="function"){e.success(n)}}};if(typeof XDomainRequest!=="undefined"&&XDomainRequest!==null){t=new XDomainRequest;t.onload=function(){return o(t.responseText)};t.open("get",r);t.send()}else{i=new XMLHttpRequest;i.open("GET",r);i.onreadystatechange=function(){if(i.readyState===4){o(i.responseText)}};i.send()}};r=function(e){var o;o=document.createElement("iframe");o.src="about:blank";o._postAction=e;o.name="dropbox-dropins";o.style.display="block";o.style.backgroundColor="white";o.style.border="none";return o};Dropbox.initWidget=function(e){var o,n,r,t,i;o=document.createElement("form");o.target=e.name;o.method="POST";o.action=e._postAction;t={web_session_token:Dropbox.webSessionToken};for(r in t){i=t[r];n=document.createElement("input");n.type="hidden";n.name=r;n.value=i;o.appendChild(n)}e.parentNode.appendChild(o);o.submit();e.parentNode.removeChild(o)};Dropbox.initChooserWidget=Dropbox.initWidget;Dropbox.createSaverWidget=function(e){var o,n=this;o=r(p(e));o._handler=function(n){if(n.source===o.contentWindow&&n.origin===Dropbox.baseUrl){i(n,null,e)}};Dropbox.addListener(window,"message",o._handler);return o};Dropbox.MAX_UPLOAD_SIZE=157286400;Dropbox.disableJSONP=true;Dropbox.forceDropdown=true;Dropbox.VERSION="2";Dropbox.cleanupChooserWidget=Dropbox.cleanupWidget}).call(this);e.namespace("Tictac.dropbox").api=Dropbox;Dropbox.init("rc6y8k4iymkdqye")},"1.0.0",{requires:[]});YUI.add("tictac-dropbox-auth",function(e){var o=e.Tictac.base,n=e.Tictac.dropbox.api,t=o.utils.log,s=o.utils.verify,i="https://"+location.hostname,a=null,c=null,r=null,d,l=e.Tictac.dropbox.Stats.stat,u=e.Tictac.dropbox.strings,f,g;function m(e){r=e;n.setWebSessionToken(r)}function p(){e.common.net.Error.simpleRelogin()}g={deleteToken:function(){r=null;n.setWebSessionToken(null);g.sendXDMMessage({method:"dropboxSetToken",params:{ssoToken:"",wssid:f||NeoConfig.wssid}},function(){})},getToken:function(o,s){var i=this,a;function c(){if(a){a.destroy()}}function l(){clearTimeout(d);d=null;c()}t("auth.getToken");if(r){o({token:r,src:"session"});return}d=setTimeout(function(){e.common.ui.DialogHelper.cancelDialog({hd:s.hd||u.str_share_from_db,bd:"",noScroll:true},{cancel:{handler:function(){if(s.cancel){s.cancel()}c()}}},function(e){var o=e.get("contentBox");a=e;if(!d){c()}e.hide();o.addClass("tictac-dropbox-chooser-loading-dialog");o.one(".modal-bd").addClass("dropbox-loading");e.show();e.center()})},500);i.sendXDMMessage({method:"dropboxGetToken",params:{wssid:f||NeoConfig.wssid}},function(t){if(t.status===404||t.status===302||t.status===0){l();e.once("net:reloginSuccessful",function(){i.getToken(o,s)});p();return}else if(t.status===402||t.status===403){l();if(e.Object.getValue(t,["message","wssid"])){f=t.message.wssid}i.getToken(o,s);return}if(!e.Object.getValue(t,["message","ssoToken"])){l();i.linkDropboxAccount(o,s);return}m(t.message.ssoToken);if(!NeoConfig.isFullSSL&&e.UA.ie){l();o({token:r,src:"credstore"});return}n.checkWebSessionToken({success:function(){l();o({token:r,src:"credstore"})},failure:function(){l();i.deleteToken();i.linkDropboxAccount(o,s)}})})},getTokenSync:function(){s(r,"getTokenSync is tokenless");return r},linkDropboxAccount:function(o,s){e.common.ui.DialogHelper.confirm({hd:s.hd||u["str_share_files_from_db"],bd:s.bd||e.Tictac.dropbox.rollups.disclaimer({headline:u["str_yahoo_partner_db_store_on_db"],body:u["str_db_free_service_disclaimer"]}),noScroll:true},{ok:{handler:function(){l("dropbox_link_ok")}},cancel:{handler:function(){if(s.cancel){s.cancel()}l("dropbox_link_cancelled")}}},function(e){var i=e.get("contentBox");i.addClass("tictac-dropbox-disclaimer-dialog");i.one("#okayModalOverlay a").on("click",function(){var e={},i=NeoConfig.emailAddress;if(!i||i===""){i=NeoConfig.loginId.indexOf("@")<0?NeoConfig.loginId+"@yahoo.com":NeoConfig.loginId}if(NeoConfig&&NeoConfig.userDataObj&&NeoConfig.userDataObj.userSendPref){e=NeoConfig.userDataObj.userSendPref}n.getWebSessionApproval({success:function(e){t("SSO token iz:",e);if(!e){l("dropbox_sso_success_no_token");return}l("dropbox_sso_success");m(e);o({token:r,src:"partner"});g.sendXDMMessage({method:"dropboxSetToken",params:{ssoToken:r,wssid:f||NeoConfig.wssid}},function(){})},cancel:function(){t("SSO fail");l("dropbox_sso_failed");if(s.cancel){s.cancel()}}},{fname:e.firstName,lname:e.lastName,email:i})})})},createXDMIframe:function(){if(a){return}var o=this,n='<iframe src="'+i+"/neo/tictacSecureXDM"+(NeoConfig.isFullSSL?"?tp=s":"")+'" id="tictac_xdm" style="display:none" role="presentation" tabIndex="-1">';a=e.Node.create(n);e.one(document.body).append(a);e.one(window).on("message",function(n){var t=n._event,s;if(t.origin!==i){return}s=e.JSON.parse(t.data);if(s.method==="XDMReady"){c=a.getDOMNode().contentWindow}if(t.source===c){o.fire("XDM"+":"+s.method,s.params)}})},sendXDMMessage:function(e,o,n){var t=this,s=function(){c.postMessage(JSON.stringify(e),i)};t.once("XDM:"+e.method+"Response",o,n);if(c){s()}else{t.on("XDM:XDMReady",function(){s()})}}};e.augment(g,e.EventTarget);e.namespace("Tictac.dropbox").auth=g;g.createXDMIframe()},"1.0.0",{requires:["common-ui-dialog-helper","tictac-base-utils","tictac-dropbox-stats","tictac-dropbox-api"]});YUI.add("tictac-dropbox-strings",function(o){o.namespace("Tictac.dropbox").strings={str_branding_dropbox_no_trans:"Dropbox",str_branding_yahoo:"Yahoo!",str_chooser_invalid_response:"Unexpected Dropbox failure, please try again later.",str_db_attach_large_files:"Attach large files with Dropbox",str_db_free_service_disclaimer:"By clicking OK, your name and email address will be sent to Dropbox.",str_dropbox_alf_error_uploading:"There was a problem uploading the file {{filename}}.",str_dropbox_alf_over_quota_error:"Your Dropbox account is over quota size.",str_dropbox_alf_over_quota_error_link:"Get more space",str_dropbox_alf_over_size:"<a href='{{dropbox_oversize_url}}' target='_blank'>Learn how</a> to send files larger than 150 MB with Yahoo! and Dropbox.",str_dropbox_alf_over_size_error_multiple:"These files are too big.",str_dropbox_alf_over_size_error_single:"This file is too big.",str_dropbox_alf_problem_connecting:"Connection to your Dropbox account failed. Please try again.",str_dropbox_alf_unknown_error:"An unknown error occurred.",str_dropbox_file_exceed_25MB:"This file exceeds 25MB. Use your Dropbox account to send this file.",str_dropbox_files_exceed_25MB:"These files exceed 25MB. Use your Dropbox account to send these files.",str_dropbox_msg_footer:"{{username}} shared this file from Dropbox:",str_dropbox_msg_footer_from_dropbox:"from Dropbox",str_dropbox_msg_footer_plural:"{{username}} shared these files from Dropbox:",str_dropbox_saveto_complete_plural:"Saved {{num}} files to Dropbox.",str_dropbox_saveto_complete_singular:"Saved 1 file to Dropbox.",str_dropbox_saveto_in_progress:"If you leave or reload this page, your attachments will not finish saving to Dropbox.",str_dropbox_saveto_no_URLs:"Unexpected attachment failure, please try again later.",str_dropbox_saveto_transfer_error:"Unable to save to Dropbox.",str_learn_more_db:"Learn more about Dropbox",str_save_attach_to_db:"Save large attachments to Dropbox",str_share_files_from_db:"Share files from Dropbox",str_share_from_db:"Share from Dropbox",str_yahoo_partner_db_25mb:"Yahoo! has partnered with Dropbox for large file attachments.",str_yahoo_partner_db_save_to_cloud:"Yahoo! has partnered with Dropbox for large file attachments.",str_yahoo_partner_db_store_on_db:"Yahoo! has partnered with Dropbox for large file attachments.",last:null}},"1.0.0");YUI.add("tictac-dropbox-rollups",function(a){a.namespace("Tictac.dropbox.rollups");a.Tictac.dropbox.rollups.disclaimer=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s="function",r=this.escapeExpression;o+='<div class="dropbox-dialog"><img src="https://s.yimg.com/tq/dropbox/130911174750/img/disclaimer-ymail-trans-09102013.png"/><img src="https://s.yimg.com/tq/dropbox/130911174750/img/dropbox-logo.png"/><p>';if(p=t.headline){p=p.call(e,{hash:{},data:i})}else{p=e.headline;p=typeof p===s?p.apply(e):p}o+=r(p)+" ";if(p=t.body){p=p.call(e,{hash:{},data:i})}else{p=e.body;p=typeof p===s?p.apply(e):p}o+=r(p)+'</p><a href="https://www.dropbox.com/tour" target="_blank">  Learn more about Dropbox </a></div>';return o});a.Tictac.dropbox.rollups.limit=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s="function",r=this.escapeExpression;o+='<div class="dropbox-dialog">  <div>   ';if(p=t.too_big_msg){p=p.call(e,{hash:{},data:i})}else{p=e.too_big_msg;p=typeof p===s?p.apply(e):p}o+=r(p)+"   ";if(p=t.learn_how_msg){p=p.call(e,{hash:{},data:i})}else{p=e.learn_how_msg;p=typeof p===s?p.apply(e):p}if(p||p===0){o+=p}o+="  </div></div>";return o});a.Tictac.dropbox.rollups.quota=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s="function",r=this.escapeExpression;o+='<div class="dropbox-dialog">  <div>   ';if(p=t.body_text){p=p.call(e,{hash:{},data:i})}else{p=e.body_text;p=typeof p===s?p.apply(e):p}o+=r(p)+'    <a href="';if(p=t.link){p=p.call(e,{hash:{},data:i})}else{p=e.link;p=typeof p===s?p.apply(e):p}o+=r(p)+'" target="_blank">      ';if(p=t.link_text){p=p.call(e,{hash:{},data:i})}else{p=e.link_text;p=typeof p===s?p.apply(e):p}o+=r(p)+"    </a>    ";if(p=t.end_text){p=p.call(e,{hash:{},data:i})}else{p=e.end_text;p=typeof p===s?p.apply(e):p}o+=r(p)+"  </div></div>";return o});a.Tictac.dropbox.rollups.alfview=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s="function",r=this.escapeExpression;o+='<div class="dropbox-alf-uploading">  Uploading ';if(p=t.num){p=p.call(e,{hash:{},data:i})}else{p=e.num;p=typeof p===s?p.apply(e):p}o+=r(p)+" of ";if(p=t.total){p=p.call(e,{hash:{},data:i})}else{p=e.total;p=typeof p===s?p.apply(e):p}o+=r(p)+'  <div class="dropbox-alf-progressbar"></div>  <div class="dropbox-alf-filename"></div>  <div class="dropbox-alf-error"></div></div>';return o});a.Tictac.dropbox.rollups.plainfooter=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s,r="function",n=this.escapeExpression,d=this,c=t.blockHelperMissing;function f(a,e){var l="",i,o;l+='        <div class="db-attachment" style="margin-bottom:-12px">            <span style="padding-right:12px">+&nbsp;<a rel="nofollow" target="_blank" href="'+n((i=(i=a.dropbox,i==null||i===false?i:i.link),typeof i===r?i.apply(a):i))+'">'+n((i=(i=a.dropbox,i==null||i===false?i:i.link),typeof i===r?i.apply(a):i))+'</a></span>            <span id="db-attachment-';if(o=t.id){o=o.call(a,{hash:{},data:e})}else{o=a.id;o=typeof o===r?o.apply(a):o}l+=n(o)+'" style="padding-right:24px;padding-top:3px;background-position:right -327px;background-repeat: no-repeat; cursor: pointer; visibility: hidden;" class="db-attachment-delete">            </span>        </div>    <br/>     ';return l}o+='<div class="tictac-att-dropbox-container" contenteditable="false">    <br/><br/>    ';if(p=t.preamble){p=p.call(e,{hash:{},data:i})}else{p=e.preamble;p=typeof p===r?p.apply(e):p}o+=n(p)+"<br/>    ";s={hash:{},inverse:d.noop,fn:d.program(1,f,i),data:i};if(p=t.attachments){p=p.call(e,s)}else{p=e.attachments;p=typeof p===r?p.apply(e):p}if(!t.attachments){p=c.call(e,p,s)}if(p||p===0){o+=p}o+="</div>";return o});a.Tictac.dropbox.rollups.richfooter=a.Handlebars.template(function(a,e,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,a.helpers);i=i||{};var o="",p,s,r="function",n=this.escapeExpression,d=this,c=t.blockHelperMissing;function f(a,e){var l="",i,o;l+='        <div id="db-attachment-';if(i=t.id){i=i.call(a,{hash:{},data:e})}else{i=a.id;i=typeof i===r?i.apply(a):i}l+=n(i)+'" class="db-attachment" style="min-height:36px">            <span style="display:inline-block;position:relative;line-height:19px;z-index:110;font-size:11px;min-width:30px;padding:0 8px;font-family:Helvetica,sans-serif;text-transform:uppercase;text-align:center;color:#fff;text-overflow:ellipsis;';if(i=t.iconcolor){i=i.call(a,{hash:{},data:e})}else{i=a.iconcolor;i=typeof i===r?i.apply(a):i}l+=n(i)+'">';if(i=t.filetype){i=i.call(a,{hash:{},data:e})}else{i=a.filetype;i=typeof i===r?i.apply(a):i}l+=n(i)+'</span>            <span class="attachment" style="margin-left:12px;margin-top:2px;font-family:\'helvetica light\',sans-serif;font-size:12px;color:#6E6E6E;">                <a rel="nofollow" target="_blank" href="'+n((i=(i=a.dropbox,i==null||i===false?i:i.link),typeof i===r?i.apply(a):i))+'" style="color:#6E6E6E;">';if(o=t.rawFilename){o=o.call(a,{hash:{},data:e})}else{o=a.rawFilename;o=typeof o===r?o.apply(a):o}l+=n(o)+'</a>            </span>            <span class="db-attachment-delete" style="top:0px;right:0px;margin-left:12px;margin-top:-1px;padding-right:24px;background-position: right -327px;background-repeat: no-repeat; cursor:pointer; visibility: hidden;"></span>        </div>     ';return l}o+='<div class="tictac-att-dropbox-container" contenteditable="false" style="margin-top:15px;background-color: rgb(255, 255, 255);">    <div class="title" style="margin-bottom:15px">';if(p=t.preamble){p=p.call(e,{hash:{},data:i})}else{p=e.preamble;p=typeof p===r?p.apply(e):p}o+=n(p)+"</div>    ";s={hash:{},inverse:d.noop,fn:d.program(1,f,i),data:i};if(p=t.attachments){p=p.call(e,s)}else{p=e.attachments;p=typeof p===r?p.apply(e):p}if(!t.attachments){p=c.call(e,p,s)}if(p||p===0){o+=p}o+="</div>";return o})},"1.0.0",{requires:["handlebars-base"]});YUI.add("tictac-dropbox-stats",function(o){var e={dropbox_link_ok:47,dropbox_link_cancelled:48,dropbox_sso_success:49,dropbox_sso_failed:50,dropbox_invalid_chooser:51,dropbox_share_from_activated:52,dropbox_sso_success_no_token:53,dropbox_alf_enable_ok:54,dropbox_alf_enable_cancel:55,dropbox_saveto:56,dropbox_sign_out_unlink:57,dropbox_rte_footer_delete:58,dropbox_alf_cancel_button:59},a={action:17,bucket:28,message:20,count:29,size:30},t={dropbox_link_ok:true,dropbox_link_cancelled:true,dropbox_share_from_activated:true,dropbox_alf_enable_ok:true,dropbox_enable_cancel:true},_={name:"dropbox",appId:"1000934436956",isSampled:Math.floor(Math.random()*100+0)===0,actionEnums:e,customFieldEnums:a},r=new o.Tictac.base.Stats({name:"db",ywa:_,ultActions:t});o.namespace("Tictac.dropbox.Stats").stat=function(o,e){r.stat(o,e?e:{})}},"1.0.0",{requires:["tictac-base-stats"]});YUI.add("tictac-dropbox-chooser",function(o){var e=o.Tictac.base,i=o.Tictac.dropbox.strings,c=e.utils.log,s=o.Tictac.dropbox.api;var n={chooseFiles:function(e){c("chooser.chooseFiles");var n,t,r;function a(){n.removeChild(t);s.cleanupChooserWidget(t);if(r){r.destroy()}}function d(o){o=o||[];a();if(e.success){e.success(o)}}function l(){a();if(e.cancel){e.cancel()}}function u(){a();o.Tictac.dropbox.auth.deleteToken();if(e.webSessionUnlinked){e.webSessionUnlinked()}}function h(){a();o.Tictac.dropbox.auth.deleteToken();if(e.ssoFailure){e.ssoFailure()}}function p(){n=o.one("#dropboxChooser");t=s.createChooserWidget({multiselect:true,success:d,cancel:l,webSessionUnlinked:u,webSessionFailure:h});n.appendChild(t);s.initChooserWidget(t)}if(!(o.Object.getValue(o,"Env._loader.groups.mail.modules".split("."))&&o.Env._loader.groups.mail.modules["common-ui-dialog-helper"])){p();return}o.use("common-ui-dialog-helper",function(o){o.common.ui.DialogHelper.custom({hd:i["str_share_from_db"],bd:'<div id="dropboxChooser"></div>',noScroll:true},{cancel:{handler:l}},function(o){var e=o.get("contentBox");e.one(".modal-hd").remove();o.hide();e.addClass("tictac-dropbox-chooser-dialog");o.show();o.center();r=o});p()})}};o.namespace("Tictac.dropbox").chooser=n},"1.0.0",{requires:["tictac-base-utils","tictac-dropbox-api","tictac-dropbox-strings"]});YUI.add("tictac-dropbox-saver",function(e){var o=e.Tictac.base,i=o.utils.log,r=e.Tictac.dropbox.api;var s={saveToDirectory:function(o){i("saver.chooseDirectory");var s,n,c;function t(){i("saver destroy");s.removeChild(n);r.cleanupChooserWidget(n);if(c){c.destroy()}}function a(e){i("saver success: "+e);t();if(o.success){o.success()}}function d(){i("saver cancel");t();if(o.cancel){o.cancel()}}function l(e){i("saver progress: "+e);c.hide();if(o.progress){o.progress()}}function u(){i("saver WebSessionUnlinked");t();e.Tictac.dropbox.auth.deleteToken();if(o.webSessionUnlinked){o.webSessionUnlinked()}}function p(){i("saver ssoFailure");t();e.Tictac.dropbox.auth.deleteToken();if(o.ssoFailure){o.ssoFailure()}}function v(){t();if(o.error){o.error()}}function f(e){var o=c.get("contentBox").one("#dropboxSaver"),r=o.one("iframe"),s={width:e.width+"px",height:e.height+"px"};i("saver resize");o.setStyles(s);r.setStyles(s);c.center()}function h(){s=e.one("#dropboxSaver");n=r.createSaverWidget({files:o.files||[],success:a,cancel:d,progress:l,webSessionUnlinked:u,webSessionFailure:p,error:v,resize:f});s.appendChild(n);r.initChooserWidget(n)}if(!(e.Object.getValue(e,"Env._loader.groups.mail.modules".split("."))&&e.Env._loader.groups.mail.modules["common-ui-dialog-helper"])){h();return}e.use("common-ui-dialog-helper",function(e){e.common.ui.DialogHelper.custom({bd:'<div id="dropboxSaver"></div>',noScroll:true},{cancel:{handler:d}},function(e){var o=e.get("contentBox");o.one(".modal-hd").remove();e.hide();o.addClass("tictac-dropbox-chooser-dialog");e.show();e.center();c=e});h()})}};e.namespace("Tictac.dropbox").saver=s},"1.0.0",{requires:["tictac-base-utils","tictac-dropbox-api","tictac-dropbox-strings"]});
YUI.add("tictac-flickr-strings",function(r){r.namespace("Tictac.flickr").strings={str_branding_flickr_no_trans:"Flickr",str_branding_yahoo:"Yahoo",str_chooser_form_upload:"Uploading photo to Flickr...",str_chooser_upload:"Uploading {{num}} of {{total}}",str_confirm_dialog_body_linked:"You are signed in to Flickr with your Yahoo ID ",str_confirm_dialog_body_new:"Your new Flickr account has been created.",str_confirm_dialog_title:"Welcome!",str_create_one_now:"<a href='{{flickr_sets_url}}' target='_blank'>Create one now</a>",str_dragndrop:"Drag and drop photos here.",str_fetching_photo_info_flickr:"Fetching photo information from Flickr...",str_flickr_msg_footer:"{{username}} shared this photo from Flickr:",str_flickr_msg_footer_plural:"{{username}} shared these photos from Flickr:",str_flickr_msg_set_footer:"{{username}} shared this set from Flickr:",str_flickr_msg_set_footer_plural:"{{username}} shared these sets from Flickr:",str_guest_all_photos_set:"All of the photos in the selected set have been marked as private.  Are you sure you want to share them?",str_guest_all_photos_sets:"All of the photos in the selected sets have been marked as private.  Are you sure you want to share them?",str_guest_some_photos_set:"Some of the photos in the selected set have been marked as private.",str_guest_some_photos_sets:"Some of the photos in the selected sets have been marked as private.",str_learn_more_privacy:"<a href='{{url_learn_more}}' target='_blank'>Learn more about Flickr</a> and <a href='{{url_privacy}}' target='_blank'>privacy at Flickr</a>",str_no_name:"(no name given)",str_no_photos_flickr_add_some:"<a href='{{flickr_upload_url}}' target='_blank'>Add some now</a>",str_no_photos_flickr_click_ok_add_some:"Click OK to go to Flickr and add some!",str_no_photos_flickr_stream:"There are no photos in your Flickr photostream.",str_no_sets:"We didn't find any sets in your Flickr account.",str_photos_count_plural:"{{num}} photos",str_photos_count_singular:"{{num}} photo",str_photostream:"Photostream",str_planned_maint:"Flickr is undergoing planned maintenance. Please try again later.",str_please_login:"Please <a href='{{flickr_login_url}}' target='_blank'>log in to Flickr</a> to fix the problem.",str_problem_connecting:"There was a problem connecting with Flickr.",str_save_attach_to_flickr:"Save large attachments to Flickr",str_seen_as:"You will be seen on Flickr as:",str_sets:"Sets",str_share_files_from_flickr:"Share files from Flickr",str_share_from_flickr:"Share from Flickr",str_share_photos_body:"Yahoo and Flickr: perfect for sharing photos and videos. Click OK to link your existing Flickr account or create a new account based on your Yahoo ID.",str_share_photos_from_flickr:"Share photos from Flickr",str_sorry:"We're sorry",str_untitled:"Untitled",str_upload_link:"Upload",str_upload_tooltip:"Upload Photo [or Drag and Drop]",last:null}},"1.0.0");YUI.add("tictac-flickr-rollups",function(e){e.namespace("Tictac.flickr.rollups");e.Tictac.flickr.rollups.authError=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function",p=this.escapeExpression;s+="<div>    <p>";if(r=t.error){r=r.call(a,{hash:{},data:i})}else{r=a.error;r=typeof r===o?r.apply(a):r}s+=p(r)+"</p>    <p>";if(r=t.solution){r=r.call(a,{hash:{},data:i})}else{r=a.solution;r=typeof r===o?r.apply(a):r}if(r||r===0){s+=r}s+="</p></div>";return s});e.Tictac.flickr.rollups.upload=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};return'<div id="flickr-status"></div><div id="flickr-progressbar"></div><span id="uploadCancelModalOverlay" class="btn left right">    <a class="close" href="#" title="Cancel">Cancel</a></span>'});e.Tictac.flickr.rollups.chooser_bottom=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function",p=this.escapeExpression;s+='<div id="upload-link-bottom">';if(r=t.upload_link){r=r.call(a,{hash:{},data:i})}else{r=a.upload_link;r=typeof r===o?r.apply(a):r}s+=p(r)+'</div><div id="flickr-upload-view"></div><span class="countModalOverlay btn left right"><a href="#" role="button"></a></span><div id="flickr-error">There was a problem uploading your files.</div>';return s});e.Tictac.flickr.rollups.confirmation=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function",p=this.escapeExpression;s+='<div id="flickrConfirmation" class="flickr-dialog">    <p>        ';if(r=t.body){r=r.call(a,{hash:{},data:i})}else{r=a.body;r=typeof r===o?r.apply(a):r}s+=p(r)+" ";if(r=t.yid){r=r.call(a,{hash:{},data:i})}else{r=a.yid;r=typeof r===o?r.apply(a):r}s+=p(r)+"    </p>    <div>        You will be seen on Flickr as:    </div>    <table class='userInfo'>        <tr>            <td>Your name</td>            <td id=\"realName\">";if(r=t.realName){r=r.call(a,{hash:{},data:i})}else{r=a.realName;r=typeof r===o?r.apply(a):r}s+=p(r)+'</td>        </tr>        <tr>            <td>Username</td>            <td id="screenName">';if(r=t.screenName){r=r.call(a,{hash:{},data:i})}else{r=a.screenName;r=typeof r===o?r.apply(a):r}s+=p(r)+'</td>        </tr>    </table>    <div>        You can change these at any time in your        <a href="http://www.flickr.com/account" target="_blank">            account settings.        </a>    </div></div>';return s});e.Tictac.flickr.rollups.setlist=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s,r,o="function",p=this.escapeExpression,n=this,c=t.blockHelperMissing;function h(e,a){var l="",i;l+='<div class="flickr-row">';i=t.each.call(e,e.row,{hash:{},inverse:n.noop,fn:n.program(2,f,a),data:a});if(i||i===0){l+=i}l+="</div>";return l}function f(e,a){var l="",i;l+='    <div class="photoset-item">        <div class="photoset-item-inner">            <img src="';if(i=t.src){i=i.call(e,{hash:{},data:a})}else{i=e.src;i=typeof i===o?i.apply(e):i}l+=p(i)+'">            <div class="photoset-item-text">                <div class="photoset-item-title">';if(i=t.title){i=i.call(e,{hash:{},data:a})}else{i=e.title;i=typeof i===o?i.apply(e):i}l+=p(i)+'</div>                <div class="photoset-item-count">';if(i=t.count){i=i.call(e,{hash:{},data:a})}else{i=e.count;i=typeof i===o?i.apply(e):i}l+=p(i)+"</div>            </div>        </div>    </div>";return l}r={hash:{},inverse:n.noop,fn:n.program(1,h,i),data:i};if(s=t.rows){s=s.call(a,r)}else{s=a.rows;s=typeof s===o?s.apply(a):s}if(!t.rows){s=c.call(a,s,r)}if(s||s===0){return s}else{return""}});e.Tictac.flickr.rollups.initialDialog=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function",p=this.escapeExpression;s+='<div id="flickrDisclaimer" class="flickr-dialog"><img src="https://s.yimg.com/tq/dropbox/130911144718/img/disclaimer-ymail-trans-09102013.png"/>    <img src="https://s.yimg.com/tq/flickr/232/img/flickr_logo.png"/><p>';if(r=t.body){r=r.call(a,{hash:{},data:i})}else{r=a.body;r=typeof r===o?r.apply(a):r}s+=p(r)+"</p>    ";if(r=t.learn_more){r=r.call(a,{hash:{},data:i})}else{r=a.learn_more;r=typeof r===o?r.apply(a):r}if(r||r===0){s+=r}s+="</div>";return s});e.Tictac.flickr.rollups.chooseremptyset=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function";s+='<div class="flickr-no-data">    <p>We didn\'t find any sets in your Flickr account.</p>    ';if(r=t.createsetlink){r=r.call(a,{hash:{},data:i})}else{r=a.createsetlink;r=typeof r===o?r.apply(a):r}if(r||r===0){s+=r}s+="</div>";return s});e.Tictac.flickr.rollups.guestpassdialog=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};return'<ul>  <li>    <label>      <input type="radio" name="guest_pass" checked="" value="share_all">      Share all    </label>  </li>  <li>    <label>      <input type="radio" name="guest_pass" value="share_public">      Share only photos marked as public    </label>  </li></ul>'});e.Tictac.flickr.rollups.chooseremptyphoto=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function";s+='<div class="flickr-no-data">    <p>There are no photos in your Flickr photostream.</p>    ';if(r=t.uploadphotolink){r=r.call(a,{hash:{},data:i})}else{r=a.uploadphotolink;r=typeof r===o?r.apply(a):r}if(r||r===0){s+=r}s+="</div>";return s});e.Tictac.flickr.rollups.header=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o="function",p=this.escapeExpression;s+='<div class="title">Choose from your:</div><div id="stream" class="active">Photostream</div><div id="sets">';if(r=t.str_photoset){r=r.call(a,{hash:{},data:i})}else{r=a.str_photoset;r=typeof r===o?r.apply(a):r}s+=p(r)+'</div><div id="greeting" class="menu">';if(r=t.str_menu_greeting){r=r.call(a,{hash:{},data:i})}else{r=a.str_menu_greeting;r=typeof r===o?r.apply(a):r}s+=p(r)+"</div>";return s});e.Tictac.flickr.rollups.photolist=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s,r,o=this,p="function",n=this.escapeExpression,c=t.blockHelperMissing;function h(e,a){var l="",i;l+='<div class="flickr-row">';i=t.each.call(e,e.row,{hash:{},inverse:o.noop,fn:o.program(2,f,a),data:a});if(i||i===0){l+=i}l+="</div>";return l}function f(e,a){var l="",i;i=t["if"].call(e,e.isSelected,{hash:{},inverse:o.program(5,u,a),fn:o.program(3,d,a),data:a});if(i||i===0){l+=i}l+='<div class="photolist-item-title">    <div class="photolist-item-titletext">';if(i=t.title){i=i.call(e,{hash:{},data:a})}else{i=e.title;i=typeof i===p?i.apply(e):i}l+=n(i)+'</div></div><img src="';if(i=t.src){i=i.call(e,{hash:{},data:a})}else{i=e.src;i=typeof i===p?i.apply(e):i}l+=n(i)+'" height="';if(i=t.height){i=i.call(e,{hash:{},data:a})}else{i=e.height;i=typeof i===p?i.apply(e):i}l+=n(i)+'" width="';if(i=t.width){i=i.call(e,{hash:{},data:a})}else{i=e.width;i=typeof i===p?i.apply(e):i}l+=n(i)+'"></div></div>';return l}function d(e,a){return'<div class="photolist-item"><div class="photolist-item-inner photolist-item-selected">'}function u(e,a){return'<div class="photolist-item"><div class="photolist-item-inner">'}r={hash:{},inverse:o.noop,fn:o.program(1,h,i),data:i};if(s=t.rows){s=s.call(a,r)}else{s=a.rows;s=typeof s===p?s.apply(a):s}if(!t.rows){s=c.call(a,s,r)}if(s||s===0){return s}else{return""}});e.Tictac.flickr.rollups.footerPlain=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o,p="function",n=this.escapeExpression,c=this,h=t.blockHelperMissing;function f(e,a){var l="",i,s;l+="    ";s={hash:{},inverse:c.noop,fn:c.program(2,d,a),data:a};if(i=t.row){i=i.call(e,s)}else{i=e.row;i=typeof i===p?i.apply(e):i}if(!t.row){i=h.call(e,i,s)}if(i||i===0){l+=i}return l}function d(e,a){var l="",i,s;l+='    <div class="fk-attachment" style="margin-bottom:-12px">        <div>        ';s={hash:{},inverse:c.noop,fn:c.program(3,u,a),data:a};if(i=t.has_photo){i=i.call(e,s)}else{i=e.has_photo;i=typeof i===p?i.apply(e):i}if(!t.has_photo){i=h.call(e,i,s)}if(i||i===0){l+=i}l+="        ";s={hash:{},inverse:c.noop,fn:c.program(5,m,a),data:a};if(i=t.has_count){i=i.call(e,s)}else{i=e.has_count;i=typeof i===p?i.apply(e):i}if(!t.has_count){i=h.call(e,i,s)}if(i||i===0){l+=i}l+="        </a>        </div>    </div>    <br/>    ";return l}function u(e,a){var l="",i;l+='        + <a rel="nofollow" target="_blank" href="';if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+'">';if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+'<span style="zoom: 1;padding: 3px 24px 0 0;background-image:url(\'https://s.yimg.com/ok/u/assets/sprite/default/16x16/common-leftrail-ltr-68317.png\');background-position:right -327px;background-repeat: no-repeat; cursor: pointer; display: none;" class="fk-attachment-delete"></span>        ';return l}function m(e,a){var l="",i;l+="        + ";if(i=t.title){i=i.call(e,{hash:{},data:a})}else{i=e.title;i=typeof i===p?i.apply(e):i}l+=n(i)+' <a rel="nofollow" target="_blank" href="';if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+'">';if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+'<span style="zoom: 1;padding: 3px 24px 0 0;background-image:url(\'https://s.yimg.com/ok/u/assets/sprite/default/16x16/common-leftrail-ltr-68317.png\');background-position:right -327px;background-repeat: no-repeat; cursor: pointer; display: none;" class="fk-attachment-delete"></span>        ';return l}s+='<div class="tictac-att-flickr-container" contenteditable="false"><br/><br/>';if(r=t.title){r=r.call(a,{hash:{},data:i})}else{r=a.title;r=typeof r===p?r.apply(a):r}s+=n(r)+" <br/>";o={hash:{},inverse:c.noop,fn:c.program(1,f,i),data:i};if(r=t.rows){r=r.call(a,o)}else{r=a.rows;r=typeof r===p?r.apply(a):r}if(!t.rows){r=h.call(a,r,o)}if(r||r===0){s+=r}s+="</div>";return s});e.Tictac.flickr.rollups.footerRich=e.Handlebars.template(function(e,a,t,l,i){this.compilerInfo=[4,">= 1.0.0"];t=this.merge(t,e.helpers);i=i||{};var s="",r,o,p="function",n=this.escapeExpression,c=this,h=t.blockHelperMissing;function f(e,a){var l="",i,s;l+="    ";s={hash:{},inverse:c.noop,fn:c.program(2,d,a),data:a};if(i=t.row){i=i.call(e,s)}else{i=e.row;i=typeof i===p?i.apply(e):i}if(!t.row){i=h.call(e,i,s)}if(i||i===0){l+=i}return l}function d(e,a){var l="",i,s;l+='    <tr>        <td class="fk-attachment" style="padding-left:0px;padding-right:8px;padding-bottom:15px;padding-top:15px;">          <a rel="nofollow" target="_blank" href="';if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+'">            <span class="fk-attachment-delete" style="border-radius: 3px 3px 3px 3px; background-color: rgba(0, 0, 0, 0.6); background-color: #000; background-image:url(\'https://s.yimg.com/ok/u/assets/sprite/default/16x16/common-leftrail-ltr-68317.png\'); background-position: 0 -360px; background-repeat: no-repeat; height: 15px; width: 15px; position: absolute; cursor:pointer; display: none; left:';if(i=t.width){i=i.call(e,{hash:{},data:a})}else{i=e.width;i=typeof i===p?i.apply(e):i}l+=n(i)+'px;margin-left:-15px"></span>            <img src="';if(i=t.src){i=i.call(e,{hash:{},data:a})}else{i=e.src;i=typeof i===p?i.apply(e):i}l+=n(i)+'" height="';if(i=t.height){i=i.call(e,{hash:{},data:a})}else{i=e.height;i=typeof i===p?i.apply(e):i}l+=n(i)+'" width="';if(i=t.width){i=i.call(e,{hash:{},data:a})}else{i=e.width;i=typeof i===p?i.apply(e):i}l+=n(i)+'" style="display:block;">            <div style="background-color:#fff">                ';s={hash:{},inverse:c.noop,fn:c.program(3,u,a),data:a};if(i=t.has_photo){i=i.call(e,s)}else{i=e.has_photo;i=typeof i===p?i.apply(e):i}if(!t.has_photo){i=h.call(e,i,s)}if(i||i===0){l+=i}l+="                ";s={hash:{},inverse:c.noop,fn:c.program(5,m,a),data:a};if(i=t.has_count){i=i.call(e,s)}else{i=e.has_count;i=typeof i===p?i.apply(e):i}if(!t.has_count){i=h.call(e,i,s)}if(i||i===0){l+=i}l+="            </div>          </a>        </td>    </tr>    ";return l}function u(e,a){var l="",i;l+="                    ";if(i=t.shareURL){i=i.call(e,{hash:{},data:a})}else{i=e.shareURL;i=typeof i===p?i.apply(e):i}l+=n(i)+"                ";return l}function m(e,a){var l="",i;l+="                    ";if(i=t.title){i=i.call(e,{hash:{},data:a})}else{i=e.title;i=typeof i===p?i.apply(e):i}l+=n(i)+"                    (";if(i=t.count){i=i.call(e,{hash:{},data:a})}else{i=e.count;i=typeof i===p?i.apply(e):i}l+=n(i)+")                ";return l}s+='<div class="tictac-att-flickr-container" contenteditable="false"><table><tr><td width="600" style="width:600px;padding-top:12px;padding-bottom:12px;">';if(r=t.title){r=r.call(a,{hash:{},data:i})}else{r=a.title;r=typeof r===p?r.apply(a):r}s+=n(r)+'</td></tr></table><table style="border-spacing:0;">';o={hash:{},inverse:c.noop,fn:c.program(1,f,i),data:i};if(r=t.rows){r=r.call(a,o)}else{r=a.rows;r=typeof r===p?r.apply(a):r}if(!t.rows){r=h.call(a,r,o)}if(r||r===0){s+=r}s+="</table></div>";return s})},"1.0.0",{requires:["handlebars-base"]});YUI.add("tictac-flickr-ws",function(e){var s=e.Tictac,r=s.base.utils,o=s.base.utils.log,i="",t={},n,a=r.verify;function c(){e.common.net.Error.simpleRelogin()}function u(s,o,i){var t;if(o.status===404||o.status===302||o.status===0){e.once("net:reloginSuccessful",function(){i.retry()});c();return}else if(o.status===402||o.status===403){try{t=r.parseJSON(o.responseText)}catch(a){}n=t.wssid;i.retry();return}if(i.failure){i.failure()}}var f={call:function(s,c,l){var p=t.base||window.location.protocol+"//"+window.location.host;a(c.page>0,"only support pages > 0");var d=[p,"/neo/tt/flickr?cmd=flickrSignedURL","&method=flickr."+s||"people.getPhotos","&format=json","&nojsoncallback=1",c.extras?"&extras="+c.extras:"",c.safe_search?"&safe_search="+c.safe_search:"",c.page?"&page="+c.page:"","&per_page="+(c.perpage||"50"),"&wssid="+(n||NeoConfig.wssid)].join("");function g(s,t){var n=r.parseJSON(t.responseText),a=n?n.url:null,c=function(e,s){var o=r.parseJSON(s.responseText);if(!o){if(l.failure){l.failure();return}}l.success(o)},u=function(e,s){o("flickr CORS call error: "+e+" "+s.responseText);if(l.failure){l.failure()}};if(!a){l.failure();return}i=n.userinfo;e.io(a,{xdr:{use:"native"},on:{success:c,failure:u}})}function w(e,r){o("sign error: "+e+" "+r.responseText);if(r.status===409&&r.responseText==="TOS"&&l.failure){l.failure("TOS");return}else if(r.status===401&&!r.responseText&&l.failure){l.failure("CONN_FAILURE");return}u(e,r,{retry:function(){f.call(s,c,l)},failure:l.failure})}e.io(d,{on:{success:g,failure:w}})},signUploadURL:function(s,i){var t=[window.location.protocol+"//",window.location.host,"/neo/tt/flickr?cmd=flickrSignedUploadURL","&wssid="+(n||NeoConfig.wssid),i?"&format="+i:""].join("");function a(e,o){var i=r.parseJSON(o.responseText),t=i?i.url:null;if(!t){s.failure();return}s.success(t)}function c(e,r){o("sign error: "+e+" "+r.responseText);u(e,r,{retry:function(){f.signUploadURL(s)},failure:s.failure})}e.io(t,{on:{success:a,failure:c}})},addGuestPassURLs:function(s,i){var t=s.photos||s.sets,a=e.Array.map(t,function(e){return e.id}),c=e.merge(s),l=[window.location.protocol+"//",window.location.host,"/neo/tt/flickr?cmd=flickrGuestPassURL","&nojsoncallback=1","&wssid="+(n||NeoConfig.wssid)].join("");c[s.photos?"photos":"sets"]=a;function p(s,n){var a=r.parseJSON(n.responseText),c={},u=function(s,o){var n=r.parseJSON(o.responseText),u;u=r.getVal(n,"guestpass.photo_id",null);if(!u||u==="0"){u=r.getVal(n,"guestpass.photoset_id")}if(!u){f(s,o);return}c[u]=n.guestpass.url;delete a[u];if(e.Object.isEmpty(a)){e.Array.each(t,function(e){e.shareURL=c[e.id]});i.success()}},f=function(e,s){o("flickr CORS call error: "+e+" "+s.responseText);if(i.failure){i.failure()}};e.Array.each(e.Object.values(a),function(s){e.io(s,{xdr:{use:"native"},on:{success:u,failure:f}})})}function d(e,r){o("sign error: "+e+" "+r.responseText);u(e,r,{retry:function(){f.addGuestPassURLs(s,i)},failure:i.failure})}e.io(l,{method:"POST",data:e.JSON.stringify(c),headers:{"Content-Type":"application/json"},on:{success:p,failure:d}})},createAcct:function(s){var i=[window.location.protocol+"//",window.location.host,"/neo/tt/flickr?cmd=flickrCreateAccount","&wssid="+(n||NeoConfig.wssid)].join("");function t(e,r){o("account error: "+e+" "+r);u(e,r,{retry:function(){f.createAcct(s)},failure:s.failure})}e.io(i,{on:{success:function(e,i){var t;o("account linked");t=r.parseJSON(i.responseText);if(!t){s.failure();return}s.success(t)},failure:t}})},getCachedUserInfo:function(){return i},config:function(e){t=e}};e.namespace("Tictac.flickr").Webservice=f},"1.0.0",{requires:["io","tictac-base-utils"]});YUI.add("_shared_module_offscreen_bin_modal_btn_cancel",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_btn_cancel={base:'<span id="cancelModalOverlay" class="btn left right" data-action="cancel"><a href="#" title="{{str_btn_cancel}}" class="close" role="button">{{str_btn_cancel}}</a></span>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_modal_btns_ok_cancel",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_modal_btns_ok_cancel={base:"{{_shared_module_offscreen_bin_modal_btn_ok}}{{_shared_module_offscreen_bin_modal_btn_cancel}}"};},"1.0.0",{requires:["_shared_module_offscreen_bin_modal_btn_ok","_shared_module_offscreen_bin_modal_btn_cancel"]});/*
YUI 3.13.0 (build 3.13.0-ym3)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("node-scroll-info",function(e,t){var n=e.config.doc,r=e.config.win,i="scroll",s="scrollDown",o="scrollLeft",u="scrollRight",a="scrollUp",f="scrollToBottom",l="scrollToLeft",c="scrollToRight",h="scrollToTop";e.Plugin.ScrollInfo=e.Base.create("scrollInfoPlugin",e.Plugin.Base,[],{initializer:function(e){this._host=e.host,this._hostIsBody=this._host.get("nodeName").toLowerCase()==="body",this._scrollDelay=this.get("scrollDelay"),this._scrollMargin=this.get("scrollMargin"),this._scrollNode=this._getScrollNode(),this.refreshDimensions(),this._lastScroll=this.getScrollInfo(),this._bind()},destructor:function(){(new e.EventHandle(this._events)).detach(),this._events=null},getOffscreenNodes:function(t,n){typeof n=="undefined"&&(n=this._scrollMargin);var r=e.Selector.query(t||"*",this._host._node);return new e.NodeList(e.Array.filter(r,function(e){return!this._isElementOnscreen(e,n)},this))},getOnscreenNodes:function(t,n){typeof n=="undefined"&&(n=this._scrollMargin);var r=e.Selector.query(t||"*",this._host._node);return new e.NodeList(e.Array.filter(r,function(e){return this._isElementOnscreen(e,n)},this))},getScrollInfo:function(){var e=this._scrollNode,t=this._lastScroll,n=this._scrollMargin,r=e.scrollLeft,i=e.scrollHeight,s=e.scrollTop,o=e.scrollWidth,u=s+this._height,a=r+this._width;return{atBottom:u>i-n,atLeft:r<n,atRight:a>o-n,atTop:s<n,isScrollDown:t&&s>t.scrollTop,isScrollLeft:t&&r<t.scrollLeft,isScrollRight:t&&r>t.scrollLeft,isScrollUp:t&&s<t.scrollTop,scrollBottom:u,scrollHeight:i,scrollLeft:r,scrollRight:a,scrollTop:s,scrollWidth:o}},isNodeOnscreen:function(t,n){return t=e.one(t),!!t&&!!this._isElementOnscreen(t._node,n)},refreshDimensions:function(){var t=n.documentElement;e.UA.ios?(this._winHeight=r.innerHeight,this._winWidth=r.innerWidth):(this._winHeight=t.clientHeight,this._winWidth=t.clientWidth),this._hostIsBody?(this._height=this._winHeight,this._width=this._winWidth):(this._height=this._scrollNode.clientHeight,this._width=this._scrollNode.clientWidth),this._refreshHostBoundingRect()},_bind:function(){var t=e.one("win");this._events=[this.after({scrollDelayChange:this._afterScrollDelayChange,scrollMarginChange:this._afterScrollMarginChange}),t.on("windowresize",this._afterResize,this)],this._hostIsBody?this._events.push(t.after("scroll",this._afterHostScroll,this)):this._events.push(t.after("scroll",this._afterWindowScroll,this),this._host.after("scroll",this._afterHostScroll,this))},_getScrollNode:function(){return this._hostIsBody&&!e.UA.webkit?n.documentElement:e.Node.getDOMNode(this._host)},_isElementOnscreen:function(e,t){var n=this._hostRect,r=e.getBoundingClientRect();return typeof t=="undefined"&&(t=this._scrollMargin),!(r.top>n.bottom+t||r.bottom<n.top-t||r.right<n.left-t||r.left>n.right+t)},_refreshHostBoundingRect:function(){var e=this._winHeight,t=this._winWidth,n;this._hostIsBody?(n={bottom:e,height:e,left:0,right:t,top:0,width:t},this._isHostOnscreen=!0):n=this._scrollNode.getBoundingClientRect(),this._hostRect=n},_triggerScroll:function(t){var n=this.getScrollInfo(),r=e.merge(t,n),p=this._lastScroll;this._lastScroll=n,this.fire(i,r),n.isScrollLeft?this.fire(o,r):n.isScrollRight&&this.fire(u,r),n.isScrollUp?this.fire(a,r):n.isScrollDown&&this.fire(s,r),n.atBottom&&(!p.atBottom||n.scrollHeight>p.scrollHeight)&&this.fire(f,r),n.atLeft&&!p.atLeft&&this.fire(l,r),n.atRight&&(!p.atRight||n.scrollWidth>p.scrollWidth)&&this.fire(c,r),n.atTop&&!p.atTop&&this.fire(h,r)},_afterHostScroll:function(e){var t=this;clearTimeout(this._scrollTimeout),this._scrollTimeout=setTimeout(function(){t._triggerScroll(e)},this._scrollDelay)},_afterResize:function(){this.refreshDimensions()},_afterScrollDelayChange:function(e){this._scrollDelay=e.newVal},_afterScrollMarginChange:function(e){this._scrollMargin=e.newVal},_afterWindowScroll:function(){this._refreshHostBoundingRect()}},{NS:"scrollInfo",ATTRS:{scrollDelay:{value:50},scrollMargin:{value:50}}})},"3.13.0",{requires:["array-extras","base-build","event-resize","node-pluginhost","plugin","selector"]});
YUI.add("tictac-flickr-justifier",function(t){var i=t.Tictac.base.utils,h=i.log;function r(i,r,o,n){var a={},s,u,w,c,f=0,d,g=[],l,_,p,y,m,j,H,v;i=JSON.parse(JSON.stringify(i));t.Array.each(i,function(t){if(a[t.id]){h("unexpected photo dup id")}a[t.id]=t});if(!r||!r.rowWidth||!r.rowHeight){throw new Error("config[rowWidth, rowHeight]?")}s=r.rowHeight;u=r.rowWidth;l=r.pad||0;_=r.maxRows||false;w=[];c=0;t.Array.each(i,function(t,h){var _,M,A,I,N=a[t.id];N.justified="true";N._oheight=null;N._owidth=null;if(!N.hasOwnProperty("url_"+n)){throw new Error("config size mismatch")}H=N["width_"+n];v=N["height_"+n];d=100*s/parseInt(v,10)/100;_=Math.floor(d*parseInt(H,10));N.width=_;N.height=s;N.node_width=false;N.has_photo=true;g.push([N,c]);f+=_;M=l*g.length;if(f>u||h===i.length-1||o){d=(u-M)/f;p=g.length;f=0;y=[];for(A=0;A<p;A++){if(g[A]){N=g[A][0];if(N._oheight){m=N._oheight;j=N._owidth}else{m=N.height;j=N.width;N._oheight=N.height;N._owidth=N.width}if(Math.round(m*d)>r.rowHeight){d=r.rowHeight/m}N.height=Math.round(m*d);N.width=Math.round(j*d);e(r,N);N.rowNum=c;f+=N.width+l;N.src=N["url_"+n];if(N.width<200){N.narrowness="too-narrow"}if(N.width<110){N.narrowness="crazy-narrow"}y.push(g[A][0])}}I=u-f+l*g.length;w.push({row:y,rownum:c});g=[];f=0;c++}});if(_&&w.length>_){w=w.slice(0,_)}return w}function e(t,i){if(t.footer&&i.height_o<i.height&&i.width_o<i.width){i.height=i.height_o;i.width=i.width_o}}function o(i,h){var r=[],e=[];h=h||4;t.Array.each(i,function(t){e.push({shareURL:t.shareURL,width:"150",height:"150",src:t.src,title:t.title._content,count:t.count,has_count:!!t.count});if(e.length===h){r.push({row:e});e=[]}});if(e.length!==0){r.push({row:e})}return r}t.namespace("Tictac.flickr").justifier={justify:r,justifySets:o}},"1.0.0",{requires:["tictac-base-utils"]});YUI.add("tictac-flickr-model",function(t){var e=t.Tictac,r=e.base.utils,o=r.log,s=r.verify,i=t.Tictac.flickr,n=i.Webservice,a=i.strings,c="http://flic.kr/p/";function u(e){t.Array.each(e.photo,function(t){if(!t.title){t.title=a.str_untitled}if(!t.url_s){t.url_s=f.itemToURL(t,"s",NeoConfig.isFullSSL);t.height_s="75";t.width_s="75"}if(!t.url_z){t.url_z=f.itemToURL(t,"z",NeoConfig.isFullSSL);t.height_z="75";t.width_z="75"}});return e}function l(t){var e="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",r,o,s,i="";s=parseInt(t,10);r=s;while(s>=58){r=Math.floor(s/58);o=s-58*r;i=e.substr(o,1)+i;s=r}if(r){i=e.substr(r,1)+i}return i}var f={photos:function(t,e,r){o("Model.photos",t,e,r);e=e||{};e.page=e.page||1;e.perpage=e.perpage||50;s(t==="photostream","photosets not yet supported");s(e.perpage<100,"per_page too big");n.call("people.getPhotos",e,{success:function(t){r.success(u(t.photos))},failure:function(t){r.failure(t)}})},photosets:function(t,e){o("Model.photosets",t,e);t=t||{};t.page=t.page||1;t.perpage=t.perpage||8;s(t.perpage<20,"per_page too big");n.call("photosets.getList",t,{success:function(t){e.success(t.photosets)},failure:function(t){e.failure(t)}})},hasPrivatePhoto:function(e){return t.Array.some(e,function(t){return!t.ispublic&&!t.primary})},getPrivatePhotos:function(e){return t.Array.filter(e,function(t){return!t.ispublic&&!t.primary})},hasPrivateSet:function(e){return t.Array.some(e,function(t){return t.count_photos_all!==t.count_photos_public})},getPrivateSets:function(e){return t.Array.filter(e,function(t){return t.count_photos_all!==t.count_photos_public})},areAllPrivatePhotos:function(e){return t.Array.every(e,function(t){return t.count_photos_public==="0"})},makeShareable:function(e,r,o){var s=this,i="q",a=e.photos||e.sets,c=t.merge(e),u=e.sets?s.getPrivateSets(a):s.getPrivatePhotos(a);o=t.Lang.isUndefined(o)?false:o;c[e.sets?"sets":"photos"]=u;s.formatItems(a,i);if(!u.length||o){r.success(a);return}n.addGuestPassURLs(c,{success:function(){r.success(a)},failure:r.failure})},itemToURL:function(t,e,r){return(r?"https":"http")+"://farm"+t.farm+".staticflickr.com/"+t.server+"/"+(t.primary||t.id)+"_"+t.secret+"_"+e+".jpg"},itemToFlickrPage:function(t,e){return(e?"https":"http")+"://www.flickr.com/photos/"+(t.owner||n.getCachedUserInfo().user_id)+"/"+(t.primary?"sets/":"")+t.id},getShortenedUrl:function(t){return c+l(t.id)},urlToPhoto:function(t){var e=t.match(/https?:\/\/farm([^\.]*)\.staticflickr\.com\/([^\/]*)\/([^_]*)_([^_]*)\.*/);s(e.length===5,"urlToPhoto got bad URL: "+t);return{farm:parseInt(e[1],10),server:parseInt(e[2],10),id:e[3],secret:e[4]}},getFlickrHandle:function(){var t=n.getCachedUserInfo(),e="";if(t&&t.username){e=t.username}else if(t&&t.fullname){e=t.fullname}return e},formatItems:function(e,o){var s=this;o=o||"q";t.Array.each(e,function(t){var e;t.src=s.itemToURL(t,o,NeoConfig.isFullSSL);if(t.photos){e=t.photos==="1"?a.str_photos_count_singular:a.str_photos_count_plural;t.count=r.subs(e,{num:t.photos});t.shareURL=s.itemToFlickrPage(t)}else{t.shareURL=s.getShortenedUrl(t)}})}};t.namespace("Tictac.flickr").Model=f},"1.0.0",{requires:["tictac-base-utils","tictac-flickr-strings","tictac-flickr-ws"]});YUI.add("tictac-flickr-uploadctrl",function(e){var r,t,o,n=[],a=e.Tictac,i=a.flickr,l=i.rollups,c=i.strings,s=a.base.utils.log,p=i.Stats.stat,u=0,d=0,f={configureUpload:function(t,o){i.Webservice.signUploadURL({success:function(r){var t=r.split("?")[0],n=e.QueryString.parse(r.split("?")[1]);o({fileFieldName:"photo",url:t,postVars:n})},failure:function(){r.link.setStyle("display","none");M()}})},parseServerResponse:function(r,t){var o=e.XML.parse(t),n=o.childNodes.item(0),a;if(!n||!n.nodeName){r.reason="no resp or nodeName";return}if(n.nodeName.toUpperCase()==="XML"){n=o.childNodes.item(1)}if(!n||n.nodeName!=="rsp"){r.reason="no rsp elem";return}a=n.getAttribute("stat");if(a!=="ok"){r.reason="bad stat";return}r.reason="ok"},isSvrResponseSuccess:function(e){return e==="ok"},isSvrResponseWarning:function(){return false}};function k(){var e=r.link.get("parentNode");if(a.attach.UploaderHTML5.isBrowserCapable()){t=new a.attach.UploaderHTML5({dropArea:r.drop,fileFilters:["image/*"],selectFilesButton:r.link,btnTooltip:c.str_upload_tooltip,dragndropStr:c.str_dragndrop})}else{t=new i.UploaderForm}t.render(e);if(t.type==="HTML5"){e.one(".yui3-tictac-attach-customuploader-html5").addClass("flickr-uploader")}else{r.container.addClass("flickr-form-uploader")}return true}function _(e){p("flickr_picker_upload");r.onStart();r.error.setStyle("display","none");d=1;if(t.type==="FORM"){u=1;r.container.one("#flickr-progressbar").setHTML("<span>"+c.str_chooser_form_upload+"</span>")}else{u=e.fileList.length;if(!o){o=new a.widget.Progressbar}o.render(r.container.one("#flickr-progressbar"));t.startUpload(e,f)}s("selected "+u+" files");p("flickr_picker_upload_files_count",{count:u});L()}function m(e){s(e.percentLoaded+"% total uploaded");o.set(Math.min(e.percentLoaded,100))}function g(){s("uploaded "+d+" of "+u+" files");d+=1;p("flickr_picker_upload_success");L()}function h(){L();if(t.type==="FORM"){p("flickr_picker_upload_success");S();return}if(d<=u){b()}else{S()}}function y(){s("error uploading a file");p("flickr_picker_upload_error");M()}function b(){d=0;u=0;s("canceled");r.onCancel()}function S(e){d=0;u=0;r.onDone(e)}function U(){e.each(n,function(e){if(e.detach){e.detach()}});n=[];if(o){o.cleanup()}if(t){t.cleanup()}r.container.remove(true)}function L(){if(t.type==="FORM"){return}r.container.one("#flickr-status").setHTML(c.str_chooser_upload.replace("{{num}}",d).replace("{{total}}",u))}function M(){r.error.setStyle("display","inline-block");e.later(5e3,null,function(){r.error.setStyle("display","none")});S(true)}var v={init:function(e){r=e;if(!k()){return false}n=[t.on("fileselect",_),t.on("totaluploadprogress",m),t.on("uploadcomplete",g),t.on("alluploadscomplete",h),t.on("uploaderror",y)];r.container.append(l.upload({str_chooser_upload:c.str_chooser_upload,total:0,num:0}));return true},cleanup:function(){U()},cancelUploads:function(){p("flickr_picker_upload_cancel");t.cancel()},getUploader:function(){return t}};e.namespace("Tictac.flickr").UploadController=v},"1.0.0",{requires:["datatype-xml-parse","tictac-att-progressbar","tictac-base-utils","tictac-flickr-uploader-form","tictac-flickr-rollups","tictac-flickr-strings","tictac-flickr-stats"]});
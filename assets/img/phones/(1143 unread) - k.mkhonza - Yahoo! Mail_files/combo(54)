YUI.add("_shared_module_contact_card_email_rollup",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_contact_card_email_rollup={base:'<div class="card card-v1"> <dl class="card-info"> <dt>{{label}}</dt><dd class="icn user-email"><a title="{{email_address}}" href="#" data-name= "{{name}}" data-to="{{email_address}}" data-action="composecontact" rel="nofollow">{{email_address}}</a></dd> </dl></div>'};},"1.0.0");YUI.add("_shared_module_contact_fragments_photo",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_contact_fragments_photo={base:'<div class="photo"><img src="{{avatar_path}}" alt="{{avatar_attr}}"></div>'};},"1.0.0");YUI.add("_shared_module_contact_fragments_name",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_contact_fragments_name={base:"<h2>{{y_url}}{{name}}{{y_url1}}</h2>",y_url:'<a title="{{y_url_title}}" href="{{y_url_loc}}">',y_url1:"</a>"};},"1.0.0");YUI.add("_shared_module_offscreen_bin_contacts_menu_contact_compact_compose",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_contacts_menu_contact_compact_compose={base:'<div id="menu-contact-compact" class="optionMenu"> {{contact_card_details}} {{interactions}} <ul> <li class="searchMail" data-action="searchMail"><a href="#"><span>{{str_menu_email_history}}</span></a></li> {{view}} {{add}} </ul></div>',contact_card_details:'<div class="card" style="display:{{card_visible}}"> {{_shared_module_contact_fragments_photo}} {{_shared_module_contact_fragments_name}} </div> <ul class="first cardmenu"> <li data-action="composecontact" data-to="{{email_address}}" data-name="{{name}}" class=\'user-email active\'><a href="#"><span>{{email_address}}</span></a></li> </ul> ',edit:'<li data-action="editAddress"><a href="#"><span>{{str_menu_edit_address}}</span></a></li>',copy:'<li data-action="copyAddress" class=\'copyAddress disabled\'><a href="#"><span>{{str_menu_copy_address}}</span><em></em></a></li>',remove:'<li data-action="removeAddress"><a href="#"><span>{{str_menu_remove_address}}</span><em></em></a></li>',interactions:"<ul> {{edit}} {{copy}} {{remove}} </ul> ",view:'<li class="viewContact" data-action="viewContact"><a href="#"><span>{{str_menu_view_contact_details}}</span></a></li>',add:'<li class="addContact" data-action="addContact"><a href="#"><span>{{str_menu_add_to_contacts}}</span><em>{{str_menu_accel_shift_a}}</em></a></li>'};},"1.0.0",{requires:["_shared_module_contact_fragments_photo","_shared_module_contact_fragments_name"]});YUI.add("_shared_module_offscreen_bin_contacts_menu_contact_compact_compose_fresh",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_contacts_menu_contact_compact_compose_fresh={base:'<div id="menu-contact-compact" class="optionMenu"> <ul class="first"> {{corp_item}} {{email_item}} {{interactions}} </ul> {{email_error}} {{add}}</div>',corp_item:'<li class="light checked" data-action="corpit"><a href="#"><span>Backyard Lookup</span></a></li> ',email_item:'<li class="light checked"><a href="#"><span>{{email_address}}</span></a></li> ',edit:'<li data-action="editAddress"><a href="#"><span>{{str_menu_edit_address}}</span></a></li>',copy:'<li data-action="copyAddress" class=\'copyAddress disabled\'><a href="#"><span>{{str_menu_copy_address}}</span><em>{{copy_shortcut}}</em></a></li>',remove:'<li data-action="removeAddress"><a href="#"><span>{{str_menu_remove_address}}</span><em>{{str_menu_accel_delete}}</em></a></li>',interactions:"{{edit}} {{copy}} {{remove}} ",contact_card_details:'<li data-action="composecontact" data-to="{{email_address}}" data-name="{{name}}" class="user-email"><a href="#"><span>{{str_menu_new_message}}</span></a></li>',send_im:'<li class="imcontact" data-action="imcontact"><a href="#"><span>{{str_menu_new_instant_message}}</span></a></li>',view:'<li class="viewContact" data-action="viewContact"><a href="#"><span>{{str_menu_view_contact_details}}</span></a></li>',email_error:'<ul> {{contact_card_details}} {{send_im}} <li class="searchMail" data-action="searchMail"><a href="#"><span>{{str_menu_email_history}}</span></a></li> {{view}} </ul> ',add:'<ul><li class="addContact" data-action="addContact"><a href="#"><span>{{str_menu_add_to_contacts}}</span><em></em></a></li></ul> '};},"1.0.0");YUI.add("_shared_module_offscreen_bin_contacts_menu_contact_compact_fresh",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_contacts_menu_contact_compact_fresh={base:'<div id="menu-contact-compact" class="optionMenu"> <ul class="first"> {{corp_item}} {{email_item}} {{interactions}} {{contact_card_details}} {{send_im}} <li class="searchMail" data-action="searchMail"><a href="#"><span>{{str_menu_email_history}}</span></a></li> </ul> {{add}}</div>',corp_item:'<li class="light checked" data-action="corpit"><a href="#"><span>Backyard Lookup</span></a></li> ',email_item:'<li class="light checked"><a href="#"><span>{{email_address}}</span></a></li> ',copy:'<li data-action="copyAddress" class=\'copyAddress disabled\'><a href="#"><span>{{str_menu_copy_address}}</span><em></em></a></li> ',interactions:"{{copy}} ",contact_card_details:'<li data-action="composecontact" data-to="{{email_address}} data-name"{{name}}" class="user-email"><a href="#"><span>{{str_menu_new_message}}</span></a></li> ',send_im:'<li class="imcontact" data-action="imcontact"><a href="#"><span>{{str_menu_new_instant_message}}</span></a></li> ',add:'<ul><li class="addContact" data-action="addContact"><a href="#"><span>{{str_menu_add_to_contacts}}</span><em>{{str_menu_accel_shift_a}}</em></a></li></ul> '};},"1.0.0");YUI.add("contacts-ui-contact-popup",function(A){A.namespace("mail");var F=A.comms.Utils.escapeHtml,H=A.common.Utils.substitute,C=A.mail.ui.MessagePaneUtils,D=A.ui.Templates;var I=["_shared_module_contact_card_email_rollup","_shared_module_contact_card_sm","_shared_module_contact_card_md","_shared_module_contact_card_lg","_shared_module_offscreen_bin_contacts_menu_contact_compact_compose_fresh","_shared_module_offscreen_bin_contacts_menu_contact_compact_fresh"],K=[],E=NeoConfig.copySwfMoviePath,G="{{name}} <{{email}}>;",B=false,J=(function(){if(window.clipboardData){if(A.UA.ie>=9){return false;}return true;}return false;})(),L=A.SWFDetect.isFlashVersionAtLeast(10,1,0);A.mail.ContactPopup={TYPE_MINI:0,TYPE_SMALL:1,TYPE_MEDIUM:2,TYPE_LARGE:3,TYPE_INTERMEDIATE:4,TYPE_READONLY:5,POPUPS:[],updateContactMenu:function(R,Q){var N,M=D[I[this.TYPE_INTERMEDIATE]],P=F(Q.name),O=F(Q.email),S=F(Q.cid);N=R.one("h2");if(N){N.setContent(F(P));}N=R.one(".user-email a");if(N){N.setAttribute("data-to",O);N.setAttribute("data-name",P);N.setAttribute("title",O);N.setContent(F(O));}if(S){N=R.one("viewContact");if(N){N.show();N=R.one(".addContact");}else{N=R.one(".addContact");if(N){N.insert(H(M.view,{},null,null,strings,D),"after");}}if(N){N.hide();}}},getValidKeys:function(M){var N=[];M.all("li em").each(function(Q){var O=Q.get("text").replace(/^\s+|\s+$/g,"");O=O.split("+");for(var P=0;P<O.length;P++){if(O[P].length===1){O[P]=O[P].charCodeAt(0);}}O=(O.length===1)?O[0]:O.join("+");N.push(O);});return N;},onKeyDown:function(O,P,N){switch(P.keyCode){case 65:if(!N.inAB&&!N.editable){if(P.shiftKey){A.fire("addContact",F(N.name),F(N.email));O.menu.hide();}}break;case 67:if(N.copyable&&(P.ctrlKey||P.metaKey)){var M=O.one("input").get("value")+";";if(J){window.clipboardData.setData("text",H?H(G,N):M);}else{C.initializeCopyText();C.copyToClipboard(M,null,document.activeElement);}}break;case 8:case 46:if(N.editable){P.target=O.next(".recipient-input").one("input");A.mail.Tabs.getActiveTab().widget.composeView.header.handleDelete(P);O.menu.hide();P.target.focus();}break;}},showContactMenu:function(Z,a,j,S){var d=this,f,g,l="",O,i="",T="",W,b=j.editable,X=j.copyable,M=j.stateChangeCB,h=b||X,R,Y,U,Q="",V=false,N="";if(j.inAB){R=j.inAB;}else{U=A.contacts.utils.getContactsByEmail(j.email)||[false];if(U[0]&&U[0].id>=0){R=true;Q=U[0].id;}}if(b){if(a._data&&a._data.lozenge){V={edit:a._data.lozenge.startEdit,remove:a._data.lozenge.remove,highlight:a._data.lozenge.highlight,context:a._data.lozenge};}else{b=false;}}var P,c;if(window.mim){try{P=window.mim.Common.ABUtils.extractYidFromEmail(F(j.email));c=P?P.id:"";}finally{}}Y=j.callback||function(p){var o=F(j.name),n=F(j.email),q=parseInt(F((j.cid||Q)),10);if(!A.Lang.isNumber(q)){q="";}switch(p.dataAction){case"corpit":A.use("mail-common-corpmail",function(r){r.mail.common.corpmail.showProfile(j.email);});break;case"composecontact":var m={cbfn:function(r){var s=r.get("header");s.to=[{name:o,email:n}];r.set("header",s);}};A.fire("newMessage",m);break;case"editAddress":if(V){V.edit.call(V.context);}break;case"removeAddress":if(V){V.remove.call(V.context);}break;case"searchMail":if(NeoConfig.searchSuggestions){A.mail.ui.XobniContactsSearch.doPeopleSearch(n,function(){A.fire("fireSearch",'from:"'+n+'"');});}else{A.fire("fireSearch",'from:"'+n+'"');}break;case"viewContact":A.fire("ct:view_contact",{args:{ids:[q]}});break;case"addContact":A.fire("addContact",o,n);break;case"copyAddress":if(J){window.clipboardData.setData("text",H?H(G,j):n);}break;case"imcontact":if(c){A.fire("chats:sendIM",{id:c});}break;}};var k=(A.UA.os==="macintosh")?strings.str_contact_card_copy_mac:strings.str_contact_card_copy_pc;if(a.menu){}W=(!b)?D[I[5]]:D[I[Z]];g=H(W.contact_card_details,{name:F(j.name)||"",email_address:F(j.email)},null,null,strings,D);if(NeoConfig.isCorpmail){O=j.email.split("@");if(O.length===2&&O[1]==="yahoo-inc.com"){l=H(W.corp_item,{},null,null,strings,D);}}i=H(W.email_item,{email_address:F(j.email)},null,null,strings,D);var e=H(W.send_im,{},null,null,strings,D);if(!S){N=H(W.email_error,{contact_card_details:g,view:"",send_im:c?e:""},null,null,strings,D);}if(h){f={edit:b?W.edit:"",copy:X?H(W.copy,{copy_shortcut:k},null,null,strings,D):"",remove:b?W.remove:""};T=H(W.interactions,f,null,null,strings,D);}f={corp_item:l,email_item:i,interactions:T,email_error:N,add:(R||S)?"":W.add,contact_card_details:g,send_im:c?e:""};K[Z]=H(W.base,f,null,null,strings,D);if(A.one("#menu-contact-compact")){A.one("#menu-contact-compact").remove(true);}A.common.ui.MenuHelper.create(a,{menu:K[Z],isContext:true,contextTarget:a,xy:a.getXY(),keys:d.getValidKeys(A.Node.create(K[Z])),alignToTarget:true},function(){var m=a.menu.getMenuNode();if(M){m.on("menu:state",M);}m.on("menuSelected",Y);j.inAB=R;m.on("keydown",function(n){d.onKeyDown(a,n,j);});if(X&&!J&&L){A.use("comms-ui-clipboard-plugin",function(p){var o=p.comms.ui.ClipBoard,n=m.one(".copyAddress");n.setStyle("zIndex",m.getStyle("zIndex"));n.plug(o,{moviepath:E}).on("clipboard:load",function(){var q=this;if(!d.enableCopyOption(a.menu)){return false;}q.on("mouseover",d.setCopyString,q,j);q.clipboard.setEvent("click",function(r){d.clipboardDone.call(q,r,m);},true);q.clipboard.setEvent("mouseOver",function(r){if(A.Node.getDOMNode(a)){d.mouseOverCopyMenu.call(q,r,a.menu);m.focus();}});m.on("menu:state",function(r){if(r.state==="hide"){if(a._node&&a.hasClass("dummy_menu_node")){a.hide();}q.clipboard.hide();}});a.on("lozenge:deleted",function(){q.clipboard.removeEvent(["mouseOver","click"]);});return true;});A.on("clipboard:error",function(q){m.one(".copyAddress").addClass("disabled");B=true;});});}if(X&&J){d.enableCopyOption(a.menu);}d.POPUPS[Z]=a.menu;});},enableCopyOption:function(N){var M=N.getMenuNode();if(B){return false;}if(M&&M.one(".copyAddress")){M.one(".copyAddress").removeClass("disabled");}N.checkDescendants(true);return true;},setCopyString:function(M,N){this.setAttribute("copy",H?H(G,N):N.email);},mouseOverCopyMenu:function(N,O){var M=this;O.selectMenuItem.call(O.getMenuNode().one(".copyAddress"),M);
},clipboardDone:function(N,M){this.clipboard.hide();M.fire("menuSelected",{dataAction:"copyAddress"});M.simulate("click");}};},"1.0.0",{requires:["overlay","xobni-contacts-search","common-utils","contacts-api-utils","mail-ui-messagepane-utils","mod-contact-card_css","_shared_module_contact_card_email_rollup","comms-utils","swfdetect","common-ui-menu-helper","_shared_module_offscreen_bin_contacts_menu_contact_compact_compose","_shared_module_offscreen_bin_contacts_menu_contact_compact_compose_fresh","_shared_module_offscreen_bin_contacts_menu_contact_compact_fresh"]});
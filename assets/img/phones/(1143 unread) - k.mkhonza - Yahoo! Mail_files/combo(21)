YUI.add("minty_module_boss_preview_overlay",function(A){A.namespace("ui.Templates");A.ui.Templates.minty_module_boss_preview_overlay={base:'<div class="preview-overlay" title="{{preview_help}}"><div class="preview-bar"><div class="preview-label" dir="{{preview_dir}}">{{preview_label}}</div><div class="preview-icon icon {{preview_icon}}"></div><div class="preview-close icon icon-close {{is_fixed}}" title="{{str_close}}"></div></div><div class="preview-shim"></div></div>',is_fixed:"hidden"};},"1.0.0");YUI.add("mail-ui-boss-multitask",function(G){var T,F="boss-mt",Z="preview-label",S="preview-icon",a="preview-shim",E="preview-close",K="preview-overlay",V="preview-hidden",O="motion",C="no-transition",P="hidden",I="boss.prev",J=G.mail.ui.Boss,U=G.one("body"),M=U.one("#paneshell"),D=U.one(".boss-env"),X=M.one("#shellcontent"),A=X.one("#shellinner"),W=X.one("#tabs"),Q=G.mail.Tabs,H=G.ui.Templates.minty_module_boss_preview_overlay,R=G.common.Utils.ezSub,L=G.common.Utils.rocketstats.bucketStat,B=G.common.persist.getCookie(),N;T=function(){function l(){return U.hasClass(F);}function b(){var v=A.all("[data-tid]"),w=0,AB=16,AC,q,y,AD,z,u,AA,p,x,t,s,r="",o;v.each(function(AE){if(!AE.one("div")){return;}u=AE.getAttribute("data-tid");p=Q.getTabById(u);if(!p.isRemovable&&W){o=W.one('[data-tid="'+u+'"]');if(o&&o.get("parentNode").hasClass(P)){AE.addClass(V);AE.removeAttribute("data-mt");return;}else{AE.removeClass(V);}}AA=G.Escape.html(AE.getAttribute("data-title")||p.cfg.label);AE.setAttribute("data-mt",w++%AB);x=""+(((w-1)%AB)+1);switch(p.widgetType){case"convlist":case"messagelist":z="icon-folder";break;case"author":z="icon-compose-mail";break;case"convpane":case"messagepane":z="icon-mail-inbox";break;case"search":z="icon-search";break;default:z="";break;}if(!z){switch(u){case"tabcontacts":z="icon-contacts";break;case"tabnotepad":z="icon-notepad";break;case"tabcalendar":z="icon-calendar";break;}}q=AE.one("."+K);t=w<=9?"str_nav_boss_tasks_help":"str_nav_boss_tasks_help_nokey";if(u==="tabinbox"||(p&&p.widget&&p.widget.isDirty&&p.widget.isDirty())){s=true;}else{s=false;}if(!q){if(NeoConfig.bidi&&p.s_labelDir){r=p.s_labelDir;}q=G.Node.create(R(H.base,{is_fixed:s,preview_label:AA,preview_dir:r,preview_icon:z,preview_help:strings[t],preview_index:x},H));AE.append(q);}else{q.removeClass(P);AC=AE.one("."+Z);y=AE.one("."+S);AD=AE.one("."+E);AC.setHTML(AA);y.set("className",S+" icon "+z);if(s){AD.addClass(P);}else{AD.removeClass(P);}q.setAttribute("title",R(strings[t],{preview_index:x}));}if(w>AB){AE.addClass(V);}else{AE.removeClass(V);}});A.setAttribute("data-grid",w>=16?16:w);}function j(q){var r=q.currentTarget.ancestor("[data-tid]"),p=r&&r.getAttribute("data-tid"),o=p&&Q.getTabById(p);if(!o){G.use("common-utils-error",function(s){s.common.Utils.error.report("No valid tab reference found.","INVALID_TAB_EXCEPTION",1,1,1);});}return o;}function h(p){var o=j(p),q;if(o){A.addClass(O);if(o.isRemovable){o.set("close",1);}else{if(W){q=W.one('[data-tid="'+o.get("id")+'"]');if(q){q.get("parentNode").addClass(P);}}}}p.halt();b();}function c(q){var o=A.all("[data-mt]").item(q),p=o&&Q.getTabById(o.getAttribute("data-tid"));if(p){d(p);J.hide(false);L("boss","multitask:tabSwitchShortcut");L("boss","multitask:s_cut",q+1);}else{}}function Y(q){var p=j(q),o=true;if(p){d(p);o=false;}q.halt();L("boss","multitask:tabSwitchClick");J.hide(o);}function d(p){var o=Q.getActiveTab();if(p){if(o&&(o===p)){p.set("active",0);L("boss","multitask:sameTabSwitch");}Q.switchToTab(p,0,0,0,1);}}function k(){U.addClass(F);b();L("boss","multitask:show");}function f(){A.removeClass(O);X.addClass(C);M.addClass(C);D.addClass(C);U.removeClass(F);setTimeout(function(){X.removeClass(C);M.removeClass(C);D.removeClass(C);},100);L("boss","multitask:hide");}function i(p){var o=p.keyCode;if(l()){if(o>=49&&o<=57){c(o-49);return true;}}return false;}function n(o){N=o;o=o?1:0;B.set(I,o);L("boss","multitask:prev:"+o);}function g(){if(l()){f();n(false);}else{k();n(true);}}function e(){return N;}function m(){var o;U.delegate("click",Y,"."+a);U.delegate("click",h,"."+E);U.one(".preview-toggle").on("click",g);o=B.get(I);if(o){N=o==="1"?true:false;}else{N=false;}}m();G.mix(this,{isActive:l,show:k,hide:f,handleKeydown:i,arePreviewsEnabled:e});};G.namespace("mail.ui.Boss").Multitask=new T();},"1.0.0",{requires:["rocket-stats","mail-ui-boss","minty_module_boss_preview_overlay","common-persist-cookie-data","escape"]});